{% from "components/status_bar.jinja2" import seq_request_status_bar with context %}
{% from "components/spinner.jinja2" import spinner %}

{% for seq_request in seq_requests %}
{% if loop.last and limit == loop.index %}
<a class="element-banner" href="{{ url_for('seq_requests_page.seq_request', seq_request_id=seq_request.id) }}"
hx-get="{{ url_for('seq_requests_htmx.get_recent_seq_requests', page=current_page + 1) }}" hx-trigger="intersect once" hx-target="#seq_requests-htmx-indicator" hx-swap="outerHTML" hx-indicator="#seq_requests-htmx-indicator">
{% else %}
<a class="element-banner" href="{{ url_for('seq_requests_page.seq_request', seq_request_id=seq_request.id) }}">
{% endif %}
    <div class="row">
        <div class="title col-8">{{ loop.index }}.{{ limit }} {{ seq_request.name }}</div>
        <div class="title col-4"><span class="badge">{{ seq_request.submission_type.name }}</span></div>
    </div>
    <div class="row">
        <div class="description col-5">{{ seq_request.requestor.name }}</div>
        <div class="col-2">{{ seq_request.timestamp_submitted_str("%-d. %b.") }}</div>
        <div class="title col-5"><span class="badge">Libraries: {{ seq_request.num_libraries }}</span></div>
    </div>
    {{ seq_request_status_bar(seq_request) }}
</a>
{% endfor %}
{{ spinner(id="seq_requests-htmx-indicator") }}