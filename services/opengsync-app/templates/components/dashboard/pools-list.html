{% from "components/status_bar.jinja2" import pool_status_bar with context %}
{% from "components/spinner.jinja2" import spinner %}

{% for pool in pools %}
<div class="element-banner"
{% if loop.last and limit == loop.index %}
hx-get="{{ url_for('pools_htmx.get_recent_pools', page=current_page + 1) }}" hx-trigger="intersect once" hx-target="#pools-htmx-indicator" hx-swap="outerHTML" hx-indicator="#pools-htmx-indicator"
{% endif %}>
    <div class="row pb-1">
        <div class="title col-3"><a href="{{ url_for('pools_page.pool', pool_id=pool.id) }}">{{ pool.name }}</a></div>
        <div class="col-2">BA: {% if pool.avg_fragment_size %}✅{% else %}⚠️{% endif %}</div>
        <div class="col-2">Qubit: {% if pool.qubit_concentration %}✅{% else %}⚠️{% endif %}</div>
        <div class="col-2">E: {% if pool.experiment_id %}{{ pool.experiment.name }}{% else %}⚠️{% endif %}</div>
        <div class="description col-3">{{ pool.owner.name }}</div>
    </div>
    {{ pool_status_bar(pool) }}
</div>
{% endfor %}
{{ spinner(id="pools-htmx-indicator") }}